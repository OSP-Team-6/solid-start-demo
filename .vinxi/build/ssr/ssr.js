import{createComponent as h,isServer as A,getRequestEvent as T,delegateEvents as Q,ssrElement as C,escape as v,mergeProps as X,ssr as w,ssrHydrationKey as E,useAssets as Z,NoHydration as K,HydrationScript as ee,ssrAttribute as L,Hydration as te,renderToString as re,renderToStream as ne}from"solid-js/web";import{children as oe,createMemo as I,getOwner as se,untrack as ae,Show as z,on as ie,createRoot as ce,createSignal as le,onCleanup as O,sharedConfig as S,lazy as ue,createComponent as de,Suspense as he,ErrorBoundary as fe,catchError as me}from"solid-js";import{createRouter as pe}from"radix3";import{c as ge,a as we,R as ye,b as ve,d as be,g as N,e as Ee,s as U,m as Se,f as $e,k as Re,h as Ae,i as Te,n as ke,j as Ce,l as Le,o as Pe,p as xe,q as M,r as Ie,t as Oe}from"./assets/index-BorkS01d.js";import{provideRequestEvent as qe}from"solid-js/web/storage";import{eventHandler as Fe}from"h3";import"unctx";import"node:async_hooks";import"unstorage";import"unstorage/drivers/fs-lite";const J=e=>t=>{const{base:r}=t,o=oe(()=>t.children),n=I(()=>ge(o(),t.base||""));let a;const s=we(e,n,()=>a,{base:r,singleFlight:t.singleFlight,transformUrl:t.transformUrl});return e.create&&e.create(s),h(ye.Provider,{value:s,get children(){return h(Ne,{routerState:s,get root(){return t.root},get preload(){return t.rootPreload||t.rootLoad},get children(){return[(a=se())&&null,h(Ue,{routerState:s,get branches(){return n()}})]}})}})};function Ne(e){const t=e.routerState.location,r=e.routerState.params,o=I(()=>e.preload&&ae(()=>{U(!0),e.preload({params:r,location:t,intent:Ee()||"initial"}),U(!1)}));return h(z,{get when(){return e.root},keyed:!0,get fallback(){return e.children},children:n=>h(n,{params:r,location:t,get data(){return o()},get children(){return e.children}})})}function Ue(e){if(A){const n=T();if(n&&n.router&&n.router.dataOnly){Me(n,e.routerState,e.branches);return}n&&((n.router||(n.router={})).matches||(n.router.matches=e.routerState.matches().map(({route:a,path:s,params:i})=>({path:a.originalPath,pattern:a.pattern,match:s,params:i,info:a.info}))))}const t=[];let r;const o=I(ie(e.routerState.matches,(n,a,s)=>{let i=a&&n.length===a.length;const m=[];for(let c=0,y=n.length;c<y;c++){const b=a&&a[c],p=n[c];s&&b&&p.route.key===b.route.key?m[c]=s[c]:(i=!1,t[c]&&t[c](),ce(g=>{t[c]=g,m[c]=ve(e.routerState,m[c-1]||e.routerState.base,_(()=>o()[c+1]),()=>e.routerState.matches()[c])}))}return t.splice(n.length).forEach(c=>c()),s&&i?s:(r=m[0],m)}));return _(()=>o()&&r)()}const _=e=>()=>h(z,{get when(){return e()},keyed:!0,children:t=>h(be.Provider,{value:t,get children(){return t.outlet()}})});function Me(e,t,r){const o=new URL(e.request.url),n=N(r,new URL(e.router.previousUrl||e.request.url).pathname),a=N(r,o.pathname);for(let s=0;s<a.length;s++){(!n[s]||a[s].route!==n[s].route)&&(e.router.dataOnly=!0);const{route:i,params:m}=a[s];i.preload&&i.preload({params:m,location:t.location,intent:"preload"})}}function _e([e,t],r,o){return[e,o?n=>t(o(n)):t]}function He(e){if(e==="#")return null;try{return document.querySelector(e)}catch{return null}}function De(e){let t=!1;const r=n=>typeof n=="string"?{value:n}:n,o=_e(le(r(e.get()),{equals:(n,a)=>n.value===a.value&&n.state===a.state}),void 0,n=>(!t&&e.set(n),S.registry&&!S.done&&(S.done=!0),n));return e.init&&O(e.init((n=e.get())=>{t=!0,o[1](r(n)),t=!1})),J({signal:o,create:e.create,utils:e.utils})}function Be(e,t,r){return e.addEventListener(t,r),()=>e.removeEventListener(t,r)}function je(e,t){const r=He(`#${e}`);r?r.scrollIntoView():t&&window.scrollTo(0,0)}function Ke(e){const t=new URL(e);return t.pathname+t.search}function ze(e){let t;const r={value:e.url||(t=T())&&Ke(t.request.url)||""};return J({signal:[()=>r,o=>Object.assign(r,o)]})(e)}function Je(e=!0,t=!1,r="/_server",o){return n=>{const a=n.base.path(),s=n.navigatorFactory(n.base);let i={};function m(l){return l.namespaceURI==="http://www.w3.org/2000/svg"}function c(l){if(l.defaultPrevented||l.button!==0||l.metaKey||l.altKey||l.ctrlKey||l.shiftKey)return;const u=l.composedPath().find(F=>F instanceof Node&&F.nodeName.toUpperCase()==="A");if(!u||t&&!u.hasAttribute("link"))return;const f=m(u),d=f?u.href.baseVal:u.href;if((f?u.target.baseVal:u.target)||!d&&!u.hasAttribute("state"))return;const R=(u.getAttribute("rel")||"").split(/\s+/);if(u.hasAttribute("download")||R&&R.includes("external"))return;const k=f?new URL(d,document.baseURI):new URL(d);if(!(k.origin!==window.location.origin||a&&k.pathname&&!k.pathname.toLowerCase().startsWith(a.toLowerCase())))return[u,k]}function y(l){const u=c(l);if(!u)return;const[f,d]=u,q=n.parsePath(d.pathname+d.search+d.hash),R=f.getAttribute("state");l.preventDefault(),s(q,{resolve:!1,replace:f.hasAttribute("replace"),scroll:!f.hasAttribute("noscroll"),state:R&&JSON.parse(R)})}function b(l){const u=c(l);if(!u)return;const[f,d]=u;typeof o=="function"&&(d.pathname=o(d.pathname)),i[d.pathname]||n.preloadRoute(d,{preloadData:f.getAttribute("preload")!=="false"})}function p(l){const u=c(l);if(!u)return;const[f,d]=u;typeof o=="function"&&(d.pathname=o(d.pathname)),!i[d.pathname]&&(i[d.pathname]=setTimeout(()=>{n.preloadRoute(d,{preloadData:f.getAttribute("preload")!=="false"}),delete i[d.pathname]},200))}function g(l){const u=c(l);if(!u)return;const[,f]=u;typeof o=="function"&&(f.pathname=o(f.pathname)),i[f.pathname]&&(clearTimeout(i[f.pathname]),delete i[f.pathname])}function $(l){if(l.defaultPrevented)return;let u=l.submitter&&l.submitter.hasAttribute("formaction")?l.submitter.getAttribute("formaction"):l.target.getAttribute("action");if(!u)return;if(!u.startsWith("https://action/")){const d=new URL(u,Se);if(u=n.parsePath(d.pathname+d.search),!u.startsWith(r))return}if(l.target.method.toUpperCase()!=="POST")throw new Error("Only POST forms are supported for Actions");const f=$e.get(u);if(f){l.preventDefault();const d=new FormData(l.target,l.submitter);f.call({r:n,f:l.target},l.target.enctype==="multipart/form-data"?d:new URLSearchParams(d))}}Q(["click","submit"]),document.addEventListener("click",y),e&&(document.addEventListener("mouseover",p),document.addEventListener("mouseout",g),document.addEventListener("focusin",b),document.addEventListener("touchstart",b)),document.addEventListener("submit",$),O(()=>{document.removeEventListener("click",y),e&&(document.removeEventListener("mouseover",p),document.removeEventListener("mouseout",g),document.removeEventListener("focusin",b),document.removeEventListener("touchstart",b)),document.removeEventListener("submit",$)})}}function We(e){if(A)return ze(e);const t=()=>({value:window.location.pathname.replace(/^\/+/,"/")+window.location.search+window.location.hash,state:window.history.state}),r=Te();return De({get:t,set({value:o,replace:n,scroll:a,state:s}){n?window.history.replaceState(Re(s),"",o):window.history.pushState(s,"",o),je(decodeURIComponent(window.location.hash.slice(1)),a),Ae()},init:o=>Be(window,"popstate",ke(o,n=>{if(n&&n<0)return!r.confirm(n);{const a=t();return!r.confirm(a.value,{state:a.state})}})),create:Je(e.preload,e.explicitLinks,e.actionBase,e.transformUrl),utils:{go:o=>window.history.go(o),beforeLeave:r}})(e)}function Ge(e){e.forEach(t=>{if(!t.attrs.href)return;let r=document.head.querySelector(`link[href="${t.attrs.href}"]`);r||(r=document.createElement("link"),r.setAttribute("rel","preload"),r.setAttribute("as","style"),r.setAttribute("href",t.attrs.href),document.head.appendChild(r))})}var Ve=" ";const Ye={style:e=>C("style",e.attrs,()=>v(e.children),!0),link:e=>C("link",e.attrs,void 0,!0),script:e=>e.attrs.src?C("script",X(()=>e.attrs,{get id(){return e.key}}),()=>w(Ve),!0):null,noscript:e=>C("noscript",e.attrs,()=>v(e.children),!0)};function P(e,t){let{tag:r,attrs:{key:o,...n}={key:void 0},children:a}=e;return Ye[r]({attrs:{...n,nonce:t},key:o,children:a})}function Qe(e,t,r,o="default"){return ue(async()=>{{const a=(await e.import())[o],i=(await t.inputs?.[e.src].assets()).filter(c=>c.tag==="style"||c.attrs.rel==="stylesheet");return typeof window<"u"&&Ge(i),{default:c=>[...i.map(y=>P(y)),de(a,c)]}}})}const Xe={preload(){Ce()}},W=[{page:!0,$component:{src:"src/routes/[...404].tsx?pick=default&pick=$css",build:()=>import("./_...404_.js"),import:()=>import("./_...404_.js")},path:"/*404",filePath:"/home/chrisnash819/solid-clone/solid-start-demo/src/routes/[...404].tsx"},{page:!0,$component:{src:"src/routes/index.tsx?pick=default&pick=$css",build:()=>import("./index.js"),import:()=>import("./index.js")},$$route:{require:()=>({route:Xe}),src:"src/routes/index.tsx?pick=route"},path:"/",filePath:"/home/chrisnash819/solid-clone/solid-start-demo/src/routes/index.tsx"},{page:!0,$component:{src:"src/routes/login.tsx?pick=default&pick=$css",build:()=>import("./login.js"),import:()=>import("./login.js")},path:"/login",filePath:"/home/chrisnash819/solid-clone/solid-start-demo/src/routes/login.tsx"}],Ze=et(W.filter(e=>e.page));function et(e){function t(r,o,n,a){const s=Object.values(r).find(i=>n.startsWith(i.id+"/"));return s?(t(s.children||(s.children=[]),o,n.slice(s.id.length)),r):(r.push({...o,id:n,path:n.replace(/\/\([^)/]+\)/g,"").replace(/\([^)/]+\)/g,"")}),r)}return e.sort((r,o)=>r.path.length-o.path.length).reduce((r,o)=>t(r,o,o.path,o.path),[])}function tt(e,t){const r=nt.lookup(e);if(r&&r.route){const o=r.route[`$${t}`];return o===void 0?void 0:{handler:o,params:r.params}}}function rt(e){return e.$GET||e.$POST||e.$PUT||e.$PATCH||e.$DELETE}const nt=pe({routes:W.reduce((e,t)=>{if(!rt(t))return e;let r=t.path.replace(/\/\([^)/]+\)/g,"").replace(/\([^)/]+\)/g,"").replace(/\*([^/]*)/g,(o,n)=>`**:${n}`);if(/:[^/]*\?/g.test(r))throw new Error(`Optional parameters are not supported in API routes: ${r}`);if(e[r])throw new Error(`Duplicate API routes for "${r}" found at "${e[r].route.path}" and "${t.path}"`);return e[r]={route:t},e},{})});function G(){function e(r){return{...r,...r.$$route?r.$$route.require().route:void 0,info:{...r.$$route?r.$$route.require().route.info:{},filesystem:!0},component:r.$component&&Qe(r.$component,globalThis.MANIFEST.client,globalThis.MANIFEST.ssr),children:r.children?r.children.map(e):void 0}}return Ze.map(e)}let H;const ot=A?()=>T().routes:()=>H||(H=G());var st=["<a",' href="/">Index</a>'],at=["<a",' href="/about">About</a>'];function it(){return h(We,{root:e=>[w(st,E()),w(at,E()),h(he,{get children(){return e.children}})],get children(){return h(ot,{})}})}const V=A?e=>{const t=T();return t.response.status=e.code,t.response.statusText=e.text,O(()=>!t.nativeEvent.handled&&!t.complete&&(t.response.status=200)),null}:e=>null;var ct=["<span",' style="font-size:1.5em;text-align:center;position:fixed;left:0px;bottom:55%;width:100%;">',"</span>"],lt=["<span",' style="font-size:1.5em;text-align:center;position:fixed;left:0px;bottom:55%;width:100%;">500 | Internal Server Error</span>'];const ut=e=>{const t=A?"500 | Internal Server Error":"Error | Uncaught Client Exception";return h(fe,{fallback:r=>(console.error(r),[w(ct,E(),v(t)),h(V,{code:500})]),get children(){return e.children}})},dt=e=>{let t=!1;const r=me(()=>e.children,o=>{console.error(o),t=!!o});return t?[w(lt,E()),h(V,{code:500})]:r};var D=["<script",">","<\/script>"],ht=["<script",' type="module"'," async","><\/script>"],ft=["<script",' type="module" async',"><\/script>"];const mt=w("<!DOCTYPE html>");function Y(e,t,r=[]){for(let o=0;o<t.length;o++){const n=t[o];if(n.path!==e[0].path)continue;let a=[...r,n];if(n.children){const s=e.slice(1);if(s.length===0||(a=Y(s,n.children,a),!a))continue}return a}}function pt(e){const t=T(),r=t.nonce;let o=[];return Promise.resolve().then(async()=>{let n=[];if(t.router&&t.router.matches){const a=[...t.router.matches];for(;a.length&&(!a[0].info||!a[0].info.filesystem);)a.shift();const s=a.length&&Y(a,t.routes);if(s){const i=globalThis.MANIFEST.client.inputs;for(let m=0;m<s.length;m++){const c=s[m],y=i[c.$component.src];n.push(y.assets())}}}o=await Promise.all(n).then(a=>[...new Map(a.flat().map(s=>[s.attrs.key,s])).values()].filter(s=>s.attrs.rel==="modulepreload"&&!t.assets.find(i=>i.attrs.key===s.attrs.key)))}),Z(()=>o.length?o.map(n=>P(n)):void 0),h(K,{get children(){return[mt,h(dt,{get children(){return h(e.document,{get assets(){return[h(ee,{}),t.assets.map(n=>P(n,r))]},get scripts(){return r?[w(D,E()+L("nonce",v(r,!0),!1),`window.manifest = ${JSON.stringify(t.manifest)}`),w(ht,E(),L("nonce",v(r,!0),!1),L("src",v(globalThis.MANIFEST.client.inputs[globalThis.MANIFEST.client.handler].output.path,!0),!1))]:[w(D,E(),`window.manifest = ${JSON.stringify(t.manifest)}`),w(ft,E(),L("src",v(globalThis.MANIFEST.client.inputs[globalThis.MANIFEST.client.handler].output.path,!0),!1))]},get children(){return h(te,{get children(){return h(ut,{get children(){return h(it,{})}})}})}})}})]}})}function gt(e){const t=Le(e.nativeEvent,"flash");if(!t)return;let r=JSON.parse(t);if(!r||!r.result)return;const o=[...r.input.slice(0,-1),new Map(r.input[r.input.length-1])];Pe(e.nativeEvent,"flash","",{maxAge:0});const n=r.error?new Error(r.result):r.result;return{input:o,url:r.url,pending:!1,result:r.thrown?void 0:n,error:r.thrown?n:void 0}}async function wt(e){const t=globalThis.MANIFEST.client;return globalThis.MANIFEST.ssr,e.response.headers.set("Content-Type","text/html"),Object.assign(e,{manifest:await t.json(),assets:[...await t.inputs[t.handler].assets()],router:{submission:gt(e)},routes:G(),complete:!1,$islands:new Set})}const yt=new Set([301,302,303,307,308]);function x(e){return e.status&&yt.has(e.status)?e.status:302}function vt(e,t,r={}){return Fe({handler:o=>{const n=xe(o);return qe(n,async()=>{const a=tt(new URL(n.request.url).pathname,n.request.method);if(a){const g=(await a.handler.import())[n.request.method];n.params=a.params||{},S.context={event:n};const $=await g(n);if($!==void 0)return $;if(n.request.method!=="GET")throw new Error(`API handler for ${n.request.method} "${n.request.url}" did not return a response.`)}const s=await t(n),i=typeof r=="function"?await r(s):{...r},m=i.mode||"stream";if(i.nonce&&(s.nonce=i.nonce),m==="sync"){const p=re(()=>(S.context.event=s,e(s)),i);if(s.complete=!0,s.response&&s.response.headers.get("Location")){const g=x(s.response);return M(o,s.response.headers.get("Location"),g)}return p}if(i.onCompleteAll){const p=i.onCompleteAll;i.onCompleteAll=g=>{j(s)(g),p(g)}}else i.onCompleteAll=j(s);if(i.onCompleteShell){const p=i.onCompleteShell;i.onCompleteShell=g=>{B(s,o)(),p(g)}}else i.onCompleteShell=B(s,o);const c=ne(()=>(S.context.event=s,e(s)),i);if(s.response&&s.response.headers.get("Location")){const p=x(s.response);return M(o,s.response.headers.get("Location"),p)}if(m==="async")return c;const{writable:y,readable:b}=new TransformStream;return c.pipeTo(y),b})}})}function B(e,t){return()=>{if(e.response&&e.response.headers.get("Location")){const r=x(e.response);Ie(t,r),Oe(t,"Location",e.response.headers.get("Location"))}}}function j(e){return({write:t})=>{e.complete=!0;const r=e.response&&e.response.headers.get("Location");r&&t(`<script>window.location="${r}"<\/script>`)}}function bt(e,t){return vt(e,wt,t)}var Et=['<head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.ico">',"</head>"],St=["<html",' lang="en">','<body><div id="app">',"</div><!--$-->","<!--/--></body></html>"];const Ot=bt(()=>h(pt,{document:({assets:e,children:t,scripts:r})=>w(St,E(),h(K,{get children(){return w(Et,v(e))}}),v(t),v(r))}));export{Ot as default};
